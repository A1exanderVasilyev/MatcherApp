<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>–ú–æ–∏ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ - MatchApp</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .user-info {
            margin-bottom: 20px;
        }

        .photos-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .photo-card {
            background: white;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            text-align: center;
        }

        .photo-card img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 8px;
            margin-bottom: 10px;
        }

        .primary-badge {
            background: #4a90e2;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            display: inline-block;
            margin-bottom: 8px;
        }

        .photo-info {
            font-size: 14px;
            color: #666;
            margin: 5px 0;
        }

        .actions {
            margin-top: 10px;
        }

        .btn {
            padding: 8px 16px;
            margin: 2px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            text-decoration: none;
            display: inline-block;
            font-size: 14px;
        }

        .btn-primary {
            background: #4a90e2;
            color: white;
        }

        .btn-danger {
            background: #e74c3c;
            color: white;
        }

        .btn:hover {
            opacity: 0.8;
        }

        .no-photos {
            text-align: center;
            padding: 40px;
            background: white;
            border-radius: 10px;
            color: #666;
        }

        .upload-section {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .upload-form {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .file-input {
            flex: 1;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        .checkbox-label {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 14px;
        }
    </style>
</head>
<body>
<div class="header">
    <h1>üì∑ –ú–æ–∏ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏</h1>
    <div class="user-info" th:if="${user}">
        <h2 th:text="'–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: ' + ${user.username}">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: alex_ivanov</h2>
        <p th:text="'Email: ' + ${user.email}">Email: alex@mail.com</p>
    </div>
</div>

<div th:if="${not #lists.isEmpty(userPhotos)}">
    <h3>–ú–æ–∏ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ ([[${#lists.size(userPhotos)}]])</h3>
    <div class="photos-grid">
        <div th:each="photo : ${userPhotos}" class="photo-card">
            <div th:if="${photo.isPrimary}" class="primary-badge">‚≠ê –ì–ª–∞–≤–Ω–∞—è</div>
            <img th:src="@{/photos/{id}(id=${photo.id})}"
                 th:alt="${photo.fileName}"
                 onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZGRkIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzk5OSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPk5vIEltYWdlPC90ZXh0Pjwvc3ZnPg=='">

            <div class="photo-info">
                <strong th:text="${photo.fileName}">photo.jpg</strong>
            </div>
            <div class="photo-info" th:if="${photo.fileSize}">
                –†–∞–∑–º–µ—Ä: <span th:text="${#numbers.formatDecimal(photo.fileSize / 1024, 1, 1)}">1024</span> KB
            </div>
            <div class="photo-info">
                –ó–∞–≥—Ä—É–∂–µ–Ω–æ: <span th:text="${#temporals.format(photo.uploadedAt, 'dd.MM.yyyy HH:mm')}">01.01.2024 12:00</span>
            </div>

            <div class="actions">
                <a th:href="@{/photos/{id}/primary(id=${photo.id})}"
                   th:unless="${photo.isPrimary}"
                   class="btn btn-primary">–°–¥–µ–ª–∞—Ç—å –≥–ª–∞–≤–Ω–æ–π</a>

                <a th:href="@{/photos/{id}/delete(id=${photo.id})}"
                   class="btn btn-danger"
                   onclick="return confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç—É —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—é?')">–£–¥–∞–ª–∏—Ç—å</a>
            </div>
        </div>
    </div>
</div>

<!-- –°–æ–æ–±—â–µ–Ω–∏–µ –µ—Å–ª–∏ –Ω–µ—Ç —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π -->
<div th:if="${#lists.isEmpty(userPhotos)}" class="no-photos">
    <h3>üì∏ –£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π</h3>
    <p>–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Å–≤–æ—é –ø–µ—Ä–≤—É—é —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—é –∏—Å–ø–æ–ª—å–∑—É—è —Ñ–æ—Ä–º—É –≤—ã—à–µ</p>
</div>

<!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
<div style="text-align: center; margin-top: 30px;">
    <a href="/dashboard" class="btn btn-primary">‚Üê –ù–∞–∑–∞–¥ –≤ –ø—Ä–æ—Ñ–∏–ª—å</a>
    <a href="/auth/logout" class="btn" style="background: #95a5a6; color: white;">–í—ã–π—Ç–∏</a>
</div>

<!-- –°–æ–æ–±—â–µ–Ω–∏—è –æ–± —É—Å–ø–µ—à–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö -->
<script th:if="${param.success}">
    alert('–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–∞!');
</script>

<script th:if="${param.primary_updated}">
    alert('–ì–ª–∞–≤–Ω–∞—è —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞!');
</script>

<script th:if="${param.deleted}">
    alert('–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è —É–¥–∞–ª–µ–Ω–∞!');
</script>

</body>
</html>